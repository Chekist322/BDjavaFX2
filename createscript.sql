-- MySQL Script generated by MySQL Workbench
-- Вт 27 мар 2018 19:16:43
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';

-- -----------------------------------------------------
-- Schema mydb
-- -----------------------------------------------------

-- -----------------------------------------------------
-- Schema mydb
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `mydb` DEFAULT CHARACTER SET utf8 ;
USE `mydb` ;

-- -----------------------------------------------------
-- Table `mydb`.`Illness`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Illness` (
  `idIllness` INT NOT NULL AUTO_INCREMENT,
  `illness_name` TEXT NULL,
  PRIMARY KEY (`idIllness`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`Patient`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Patient` (
  `idPatient` INT NOT NULL AUTO_INCREMENT,
  `patientName` TEXT NULL,
  `patientSurname` TEXT NULL,
  PRIMARY KEY (`idPatient`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`PatientCard`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`PatientCard` (
  `idPatientCard` INT NOT NULL AUTO_INCREMENT,
  `patient` INT NOT NULL,
  `illness` INT NOT NULL,
  INDEX `fk_Patient_1_idx` (`illness` ASC),
  INDEX `fk_PatientCard_1_idx` (`patient` ASC),
  PRIMARY KEY (`idPatientCard`, `patient`, `illness`),
  CONSTRAINT `fk_Patient_1`
    FOREIGN KEY (`illness`)
    REFERENCES `mydb`.`Illness` (`idIllness`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_PatientCard_1`
    FOREIGN KEY (`patient`)
    REFERENCES `mydb`.`Patient` (`idPatient`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
COMMENT = 'Пациент';


-- -----------------------------------------------------
-- Table `mydb`.`Profession`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Profession` (
  `idProfession` INT NOT NULL AUTO_INCREMENT,
  `profession_name` TEXT NOT NULL,
  `payment` INT NULL,
  PRIMARY KEY (`idProfession`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`Doctor`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Doctor` (
  `idDoctor` INT NOT NULL AUTO_INCREMENT,
  `name` TEXT NULL,
  `surname` TEXT NULL,
  `profession` INT NOT NULL,
  PRIMARY KEY (`idDoctor`, `profession`),
  INDEX `fk_Doctor_Profession_idx` (`profession` ASC),
  CONSTRAINT `fk_Doctor_Profession`
    FOREIGN KEY (`profession`)
    REFERENCES `mydb`.`Profession` (`idProfession`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`Event`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`Event` (
  `idEvent` INT NULL,
  `time` DATETIME NULL,
  `patient` INT NOT NULL,
  `doctor` INT NOT NULL,
  `procedure` TEXT NULL,
  PRIMARY KEY (`patient`, `doctor`),
  INDEX `fk_Event_2_idx` (`doctor` ASC),
  INDEX `fk_Event_3_idx` (`patient` ASC),
  CONSTRAINT `fk_Event_2`
    FOREIGN KEY (`doctor`)
    REFERENCES `mydb`.`Doctor` (`idDoctor`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Event_3`
    FOREIGN KEY (`patient`)
    REFERENCES `mydb`.`PatientCard` (`idPatientCard`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;

-- -----------------------------------------------------
-- Data for table `mydb`.`Illness`
-- -----------------------------------------------------
START TRANSACTION;
USE `mydb`;
INSERT INTO `mydb`.`Illness` (`idIllness`, `illness_name`) VALUES (1, 'Рак молочной железы');
INSERT INTO `mydb`.`Illness` (`idIllness`, `illness_name`) VALUES (2, 'Рак печени');
INSERT INTO `mydb`.`Illness` (`idIllness`, `illness_name`) VALUES (3, 'Остесаркома');
INSERT INTO `mydb`.`Illness` (`idIllness`, `illness_name`) VALUES (4, 'Опухоли мягких тканей');

COMMIT;


-- -----------------------------------------------------
-- Data for table `mydb`.`Patient`
-- -----------------------------------------------------
START TRANSACTION;
USE `mydb`;
INSERT INTO `mydb`.`Patient` (`idPatient`, `patientName`, `patientSurname`) VALUES (1, 'Иван', 'Иванов');
INSERT INTO `mydb`.`Patient` (`idPatient`, `patientName`, `patientSurname`) VALUES (2, 'Рустем', 'Рустемов');
INSERT INTO `mydb`.`Patient` (`idPatient`, `patientName`, `patientSurname`) VALUES (3, 'Жанна', 'Витальева');

COMMIT;


-- -----------------------------------------------------
-- Data for table `mydb`.`PatientCard`
-- -----------------------------------------------------
START TRANSACTION;
USE `mydb`;
INSERT INTO `mydb`.`PatientCard` (`idPatientCard`, `patient`, `illness`) VALUES (1, 1, 2);
INSERT INTO `mydb`.`PatientCard` (`idPatientCard`, `patient`, `illness`) VALUES (2, 3, 1);
INSERT INTO `mydb`.`PatientCard` (`idPatientCard`, `patient`, `illness`) VALUES (3, 2, 4);

COMMIT;


-- -----------------------------------------------------
-- Data for table `mydb`.`Profession`
-- -----------------------------------------------------
START TRANSACTION;
USE `mydb`;
INSERT INTO `mydb`.`Profession` (`idProfession`, `profession_name`, `payment`) VALUES (1, 'Терапевт', 30000);
INSERT INTO `mydb`.`Profession` (`idProfession`, `profession_name`, `payment`) VALUES (2, 'Хирург', 80000);
INSERT INTO `mydb`.`Profession` (`idProfession`, `profession_name`, `payment`) VALUES (3, 'Медицинская Сестра', 22000);
INSERT INTO `mydb`.`Profession` (`idProfession`, `profession_name`, `payment`) VALUES (4, 'Психотерапевт', 32000);

COMMIT;


-- -----------------------------------------------------
-- Data for table `mydb`.`Doctor`
-- -----------------------------------------------------
START TRANSACTION;
USE `mydb`;
INSERT INTO `mydb`.`Doctor` (`idDoctor`, `name`, `surname`, `profession`) VALUES (1, 'Генадий', 'Генадьев', 1);
INSERT INTO `mydb`.`Doctor` (`idDoctor`, `name`, `surname`, `profession`) VALUES (2, 'Василий', 'Васильев', 2);
INSERT INTO `mydb`.`Doctor` (`idDoctor`, `name`, `surname`, `profession`) VALUES (3, 'Ольга', 'Ольговна', 3);
INSERT INTO `mydb`.`Doctor` (`idDoctor`, `name`, `surname`, `profession`) VALUES (4, 'Никанор', 'Никаноров', 4);

COMMIT;


-- -----------------------------------------------------
-- Data for table `mydb`.`Event`
-- -----------------------------------------------------
START TRANSACTION;
USE `mydb`;
INSERT INTO `mydb`.`Event` (`idEvent`, `time`, `patient`, `doctor`, `procedure`) VALUES (1, '20180528080000', 1, 2, '5');
INSERT INTO `mydb`.`Event` (`idEvent`, `time`, `patient`, `doctor`, `procedure`) VALUES (2, '20180528080000', 1, 3, '5');
INSERT INTO `mydb`.`Event` (`idEvent`, `time`, `patient`, `doctor`, `procedure`) VALUES (3, '20180528082000', 2, 3, '1');
INSERT INTO `mydb`.`Event` (`idEvent`, `time`, `patient`, `doctor`, `procedure`) VALUES (4, '20180528084000', 3, 1, '4');
INSERT INTO `mydb`.`Event` (`idEvent`, `time`, `patient`, `doctor`, `procedure`) VALUES (5, '20180528010000', 3, 4, '3');

COMMIT;

